services:
  nova-agent:
    build: .
    container_name: strata_nova_agent
    command: uv run src/agent.py --host 0.0.0.0
    ports:
      - "7860:7860"
      - "10000-10005:10000-10005/udp"
    env_file:
      - .env
    extra_hosts:
      - "host.docker.internal:host-gateway"

  # Uncomment to use Piper TTS (set TTS_SERVICE_PROVIDER=PIPER in .env)
  # piper-server:
  #   build:
  #     context: ./scripts/piper
  #   container_name: strata_piper_tts
  #   volumes:
  #     - ./voice:/app/voice
  #   environment:
  #     - PIPER_PORT=5002
  #     - CURRENT_VOICE=${CURRENT_VOICE}
  #     - CURRENT_VOICE_CONFIG=${CURRENT_VOICE_CONFIG}
  #   ports:
  #     - "5002:5002"
